% Präambel
\documentclass[
    a4paper,
    12pt,
    listof=totoc,
    toc=chapterentrydotfill
]{scrartcl}

% Allgemeine Pakete
\usepackage[utf8]{inputenc}                             % UTF-8, Umlaute
\usepackage[ngerman]{babel}                             % Deutsche Bezeichnungen
\usepackage[ngerman]{translator}                        % Deutsche Bezeichnungen
\usepackage{fancyhdr}                                   % Manipulation Kopf- & Fußzeile
\usepackage{graphicx}                                   % Unterstützung für Grafiken
\usepackage{color}                                      % Farbverwaltung
\usepackage[pdfborder={0 0 0}]{hyperref}                % Erzeugung von URLs
\usepackage{footnote}                                   % Verwaltung von Fußnoten
\usepackage{colortbl}                                   % Farben für Tabellen
\usepackage{lscape}                                     % Querformat
\usepackage{makeidx}                                    % Indexerstellung
\usepackage{ragged2e}                                   % Textausrichtung
\usepackage{verbatim}                                   % Kommentarumgebung
\usepackage{marvosym}                                   % Symbolschriftart
\usepackage[autostyle=true,german=quotes]{csquotes}     % Anführungszeichen-Stil
\usepackage[printonlyused]{acronym}                     % Abkürzungsverzeichnis
\usepackage{xpatch}                                     % Macro Patching
\usepackage[figure,table]{totalcount}                   % Zähler
\usepackage{calc}                                       % Arithmetische Befehle
\usepackage{tabularx}                                   % Benutzerdefinierbare Tabellen
\usepackage{booktabs}                                   % Tabellen

% Meta-Informationen
\newcommand{\metaTitel}{\LaTeX{} Vorlage für eine Hausarbeit gemäß der Richtlinien der FOM.}
\newcommand{\metaAutor}{Theodor Test}
\newcommand{\metaMatrikelNr}{123456}
\newcommand{\metaBetreuer}{Prof.\ Dr.\ Siegbert Schnösel}
\newcommand{\metaAbgabe}{01. Januar 1970}
\newcommand{\metaStandort}{Hochschulzentrum Essen}
\newcommand{\metaOrt}{Essen}
\newcommand{\metaStudiengang}{Bachelor of Science in Prokrastination}
\newcommand{\metaSemester}{12}
\newcommand{\metaModul}{Procrastination Basics}

% Formatierung
\usepackage[
    left=   4.0cm,
    right=  2.0cm,
    top=    4.0cm,
    bottom= 2.0cm
]{geometry}
\setlength{\parindent}{0mm}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\sloppy

% Schriftarten
\usepackage[T1]{fontenc}
\usepackage{fontspec}
\setmainfont[
    Path            = fonts/,
    Extension       = .ttf,
    UprightFont     = *-Regular,
    ItalicFont      = *-Italic,
    BoldFont        = *-Bold,
    BoldItalicFont  = *-BoldItalic
]{LiberationSerif}
\setsansfont[
    Path            = fonts/,
    Extension       = .ttf,
    UprightFont     = *-Regular,
    ItalicFont      = *-Italic,
    BoldFont        = *-Bold,
    BoldItalicFont  = *-BoldItalic
]{LiberationSerif}
\setmonofont[
    Path            = fonts/,
    Extension       = .ttf,
    UprightFont     = *-Regular,
    ItalicFont      = *-Italic,
    BoldFont        = *-Bold,
    BoldItalicFont  = *-BoldItalic
]{LiberationMono}
\usepackage[onehalfspacing]{setspace}

% Silbentrennung
\usepackage{hyphsubst}
\HyphSubstIfExists{ngerman-x-latest}{
\HyphSubstLet{ngerman}{ngerman-x-latest}}{}

% Counter
\setcounter{tocdepth}{3}

% PDF Metadaten
\hypersetup{
    pdfinfo={
        Title={\metaTitel},
        Subject={\metaStudiengang},
        Author={\metaAutor},
    }
}

% Kopfzeile
\pagestyle{fancy}
\fancyhf{}
\rhead{\thepage}

% Glossar
\usepackage[toc]{glossaries}
\makeglossaries{}

% Überschriften
\usepackage{caption}
\captionsetup{
    justification=raggedright,
    labelfont=bf,
    singlelinecheck=false,
    textfont=bf
}

% Sektionsnummerierungen ohne abschließenden Punkt
\renewcommand*{\autodot}{}

% Syntax Highlighting
\usepackage{listings}
\definecolor{light-gray}{gray}{0.95}
\definecolor{dark-gray}{gray}{0.4}
\lstset{
    backgroundcolor=\color{light-gray},
    basicstyle=\ttfamily\scriptsize,
    breakatwhitespace=false,
    breaklines=true,
    commentstyle=\color{dark-gray},
    extendedchars=true,
    keepspaces=true,
    keywordstyle=\color{blue},
    language=Python,
    numbers=none,
    numbersep=5pt,
    numberstyle=\scriptsize\color{dark-gray},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stringstyle=\color{red},
    tabsize=4
}

%% Literaturmanagement
\usepackage[
    autocite=footnote,
    backend=biber,
    bibstyle=ext-authoryear,
    citestyle=authortitle,
    dashed=false,
    date=year,
    dateabbrev=false,
    giveninits=true,
    innamebeforetitle=true,
    maxbibnames=999,
    maxcitenames=3,
    mergedate=false,
    mincrossrefs=1,
    seconds=true,
    uniquename=init,
    urldate=long
]{biblatex}
\addbibresource{literatur/literatur.bib}
% Fußnoten
\renewcommand{\multicitedelim}{;\space}
\DeclareNameAlias{labelname}{family-given}
\xapptobibmacro{cite}{\setunit{\nametitledelim}\printfield{year}}{}{}
% Literaturverzeichnis
\setlength\bibhang{1cm}
\setlength{\bibinitsep}{0.75cm}
\renewcommand*{\newunitpunct}{, }
\renewcommand*{\finentrypunct}{}
\renewcommand*{\UrlFont}{\ttfamily\small}
% Quelle unter Abbildungen
\newcommand*{\abbcite}[1]{\par\raggedleft\footnotesize Quelle:~\cite{#1}}
\newcommand*{\abbeig}{\par\raggedleft\footnotesize Quelle: Eigene Darstellung}



% Inhalt ------------------------------------------------------
\begin{document}
    \lhead{\nouppercase{\leftmark}}
    \pagenumbering{Roman}
    %TC:ignore

    % Titelblatt
    \begin{titlepage}
        \begin{center}
            \begin{large}
                \includegraphics[width=5cm]{abbildungen/fom-logo.png}\\
                \vspace{1.5cm}
                \textbf{FOM {--} Hochschule für Oekonomie und Management}\\
                \metaStandort{}\\
                \vspace{1.0cm}
                Berufsbegleitender Studiengang zum\\
                \metaStudiengang{}\\
                \vspace{1.0cm}
                \metaSemester{}. Semester\\
                Hausarbeit im Modul\\
                \textbf{\metaModul{}}\\
                zum Thema\\
            \end{large}
            \vspace{1.5cm}
            \begin{Large}
                \textbf{\metaTitel{}}
            \end{Large}
        \end{center}
        \vfill
        \begin{tabbing}
            Links \= Mitte \= Mittez \= Rechts \kill
            Betreuer: \> \> \> \metaBetreuer{}\\
            Autor: \> \> \> \metaAutor{}\\
            Matrikelnr.: \> \> \> \metaMatrikelNr{}\\
            Abgabedatum: \> \> \> \metaAbgabe{}
        \end{tabbing}
    \end{titlepage}
    \newpage

    % Inhaltsverzeichnis
    \tableofcontents
    \newpage

    % Abbildungsverzeichnis
    \listoffigures
    \newpage

    % Tabellenverzeichnis
    \listoftables
    \newpage

    % Abkürzungsverzeichnis
    \lhead{Abkürzungsverzeichnis}
    \include{verzeichnisse/abkuerzungsverzeichnis}

    % Glossar
    \lhead{Glossar}
    \include{verzeichnisse/glossar}
    %TC:endignore

    % Sperrvermerk
    \lhead{Sperrvermerk}
    \include{erklaerungen/sperrvermerk}

    % Römische Seitenzahlen werden später weitergezählt
    \newcounter{fort}
    \setcounter{fort}{\value{page}}


    % Hauptteil
    \setcounter{page}{1}
    \pagenumbering{arabic}
    \lhead{\nouppercase{\leftmark}}
    % \include{hauptteil/beispiel}


    % Römische Seitenzahlen fortfahren
    \pagenumbering{Roman}
    \setcounter{page}{\value{fort}}
    %TC:ignore

    % Anhänge
    \appendix
    \setcounter{secnumdepth}{0}
    % \include{anhang/anhang}

    % Literaturverzeichnisse
    \togglefalse{abx@bool@giveninits}
    \printbibliography[heading=bibintoc, nottype=online, title=Literaturverzeichnis]
    \newpage
    \printbibliography[type=online, title=Internetquellen]
    \newpage

    \pagenumbering{gobble}

    % Ehrenwörtliche Erklärung
    \lhead{Ehrenwörtliche Erklärung}
    \include{erklaerungen/ehrenwoertliche_erklaerung}
    %TC:endignore
\end{document}
